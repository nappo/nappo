
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>nappo.core.envs package &#8212; nappo 0.0.22 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="nappo.core.storages package" href="nappo.core.storages.html" />
    <link rel="prev" title="nappo.core.algos package" href="nappo.core.algos.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nappo.core.storages.html" title="nappo.core.storages package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nappo.core.algos.html" title="nappo.core.algos package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">nappo 0.0.22 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="nappo.html" >nappo package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="nappo.core.html" accesskey="U">nappo.core package</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="nappo-core-envs-package">
<h1>nappo.core.envs package<a class="headerlink" href="#nappo-core-envs-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-nappo.core.envs.base">
<span id="nappo-core-envs-base-module"></span><h2>nappo.core.envs.base module<a class="headerlink" href="#module-nappo.core.envs.base" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-nappo.core.envs.env_wrappers">
<span id="nappo-core-envs-env-wrappers-module"></span><h2>nappo.core.envs.env_wrappers module<a class="headerlink" href="#module-nappo.core.envs.env_wrappers" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="nappo.core.envs.env_wrappers.TransposeImage">
<em class="property">class </em><code class="sig-prename descclassname">nappo.core.envs.env_wrappers.</code><code class="sig-name descname">TransposeImage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">op</span><span class="o">=</span><span class="default_value">[2, 0, 1]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nappo.core.envs.env_wrappers.TransposeImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">gym.core.ObservationWrapper</span></code></p>
<p>When environment observations are images, this wrapper allows to transpose
the axis. It is useful when the images have shape (W,H,C), as they can be
transposed “on the fly” to (C,W,H) for PyTorch convolutions to be applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> (<em>gym.Env</em>) – Original Gym environment, previous to applying the wrapper.</p></li>
<li><p><strong>op</strong> (<em>list</em>) – New axis ordering.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="nappo.core.envs.env_wrappers.TransposeImage.op">
<code class="sig-name descname">op</code><a class="headerlink" href="#nappo.core.envs.env_wrappers.TransposeImage.op" title="Permalink to this definition">¶</a></dt>
<dd><p>New axis ordering.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="nappo.core.envs.env_wrappers.TransposeImage.observation_space">
<code class="sig-name descname">observation_space</code><a class="headerlink" href="#nappo.core.envs.env_wrappers.TransposeImage.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>New observation space</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>gym.Space</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nappo.core.envs.env_wrappers.TransposeImage.observation">
<code class="sig-name descname">observation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ob</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nappo.core.envs.env_wrappers.TransposeImage.observation" title="Permalink to this definition">¶</a></dt>
<dd><p>Transpose observation</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nappo.core.envs.vec_env">
<span id="nappo-core-envs-vec-env-module"></span><h2>nappo.core.envs.vec_env module<a class="headerlink" href="#module-nappo.core.envs.vec_env" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="nappo.core.envs.vec_env.VecEnv">
<em class="property">class </em><code class="sig-prename descclassname">nappo.core.envs.vec_env.</code><code class="sig-name descname">VecEnv</code><a class="headerlink" href="#nappo.core.envs.vec_env.VecEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to handle creation of environment vectors</p>
<dl class="py method">
<dt id="nappo.core.envs.vec_env.VecEnv.create_factory">
<em class="property">classmethod </em><code class="sig-name descname">create_factory</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env_fn</span></em>, <em class="sig-param"><span class="n">env_kwargs</span></em>, <em class="sig-param"><span class="n">vec_env_size</span></em>, <em class="sig-param"><span class="n">log_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">info_keywords</span><span class="o">=</span><span class="default_value">()</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nappo.core.envs.vec_env.VecEnv.create_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function to create a vector of environments of size
num_processes, so it can be executed by any worker, remote or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_fn</strong> (<em>func</em>) – Function to create the environment.</p></li>
<li><p><strong>env_kwargs</strong> (<em>dict</em>) – keyword arguments of env_fn.</p></li>
<li><p><strong>num_processes</strong> (<em>int</em>) – size of the vector of environments.</p></li>
<li><p><strong>log_dir</strong> (<em>str</em>) – Target path for envs to log information through bench.Monitor class.</p></li>
<li><p><strong>info_keywords</strong> (<em>tuple</em>) – Information keywords to be logged stored by bench.Monitor class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>make_vec_env</strong> (<em>func</em>) – Function to create a vector of environments.</p></li>
<li><p><strong>dummy_env.action_space</strong> (<em>gym.Space</em>) – Environments action space.</p></li>
<li><p><strong>dummy_env.observation_space</strong> (<em>gym.Space</em>) – Environments observation space.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="nappo.core.envs.vec_env.make_env">
<code class="sig-prename descclassname">nappo.core.envs.vec_env.</code><code class="sig-name descname">make_env</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env_fn</span></em>, <em class="sig-param"><span class="n">env_kwargs</span></em>, <em class="sig-param"><span class="n">index_worker</span></em>, <em class="sig-param"><span class="n">index_env</span></em>, <em class="sig-param"><span class="n">log_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">info_keywords</span><span class="o">=</span><span class="default_value">()</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'train'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nappo.core.envs.vec_env.make_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function that handles the creating of a single environment, so it
can be executed in an independent thread.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_fn</strong> (<em>func</em>) – Function to create the environment.</p></li>
<li><p><strong>env_kwargs</strong> (<em>dict</em>) – keyword arguments of env_fn.</p></li>
<li><p><strong>log_dir</strong> (<em>str</em>) – Target path for bench.Monitor logger values.</p></li>
<li><p><strong>info_keywords</strong> (<em>tuple</em>) – Information keywords to be logged stored by bench.Monitor.</p></li>
<li><p><strong>index_worker</strong> (<em>int</em>) – Index of the worker running this environment.</p></li>
<li><p><strong>index_env</strong> (<em>int</em>) – Index of this environment withing the vector of environments.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – “train” or “test”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>_thunk</strong> – A function to create and return the environment. It also sets up the
Monitor logging and used a TransposeImage wrapper if environment obs
are images.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>func</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-nappo.core.envs.vector_wrappers">
<span id="nappo-core-envs-vector-wrappers-module"></span><h2>nappo.core.envs.vector_wrappers module<a class="headerlink" href="#module-nappo.core.envs.vector_wrappers" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="nappo.core.envs.vector_wrappers.VecPyTorch">
<em class="property">class </em><code class="sig-prename descclassname">nappo.core.envs.vector_wrappers.</code><code class="sig-name descname">VecPyTorch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">venv</span></em>, <em class="sig-param"><span class="n">device</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nappo.core.envs.vector_wrappers.VecPyTorch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">baselines.common.vec_env.vec_env.VecEnvWrapper</span></code></p>
<p>This wrapper turns obs, reward’s and done’s from numpy arrays to pytorch
tensors and places them in the specified device, facilitating interaction
between the environment and the actor critic function approximators (NNs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>venv</strong> (<a class="reference internal" href="#nappo.core.envs.vec_env.VecEnv" title="nappo.core.envs.vec_env.VecEnv"><em>VecEnv</em></a>) – Original vector environment, previous to applying the wrapper.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – CPU or specific GPU where obs, reward’s and done’s are placed after
being transformed into pytorch tensors.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="nappo.core.envs.vector_wrappers.VecPyTorch.device">
<code class="sig-name descname">device</code><a class="headerlink" href="#nappo.core.envs.vector_wrappers.VecPyTorch.device" title="Permalink to this definition">¶</a></dt>
<dd><p>CPU or specific GPU where obs, reward’s and done’s are placed after
being transformed into pytorch tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="nappo.core.envs.vector_wrappers.VecPyTorch.num_envs">
<code class="sig-name descname">num_envs</code><a class="headerlink" href="#nappo.core.envs.vector_wrappers.VecPyTorch.num_envs" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of vector environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nappo.core.envs.vector_wrappers.VecPyTorch.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nappo.core.envs.vector_wrappers.VecPyTorch.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>New vec env reset function</p>
</dd></dl>

<dl class="py method">
<dt id="nappo.core.envs.vector_wrappers.VecPyTorch.step_async">
<code class="sig-name descname">step_async</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">actions</span></em><span class="sig-paren">)</span><a class="headerlink" href="#nappo.core.envs.vector_wrappers.VecPyTorch.step_async" title="Permalink to this definition">¶</a></dt>
<dd><p>New vec env step_async function</p>
</dd></dl>

<dl class="py method">
<dt id="nappo.core.envs.vector_wrappers.VecPyTorch.step_wait">
<code class="sig-name descname">step_wait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nappo.core.envs.vector_wrappers.VecPyTorch.step_wait" title="Permalink to this definition">¶</a></dt>
<dd><p>New vec env step_wait function</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nappo.core.envs">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-nappo.core.envs" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">nappo.core.envs package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-nappo.core.envs.base">nappo.core.envs.base module</a></li>
<li><a class="reference internal" href="#module-nappo.core.envs.env_wrappers">nappo.core.envs.env_wrappers module</a></li>
<li><a class="reference internal" href="#module-nappo.core.envs.vec_env">nappo.core.envs.vec_env module</a></li>
<li><a class="reference internal" href="#module-nappo.core.envs.vector_wrappers">nappo.core.envs.vector_wrappers module</a></li>
<li><a class="reference internal" href="#module-nappo.core.envs">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="nappo.core.algos.html"
                        title="previous chapter">nappo.core.algos package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nappo.core.storages.html"
                        title="next chapter">nappo.core.storages package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/nappo.core.envs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nappo.core.storages.html" title="nappo.core.storages package"
             >next</a> |</li>
        <li class="right" >
          <a href="nappo.core.algos.html" title="nappo.core.algos package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">nappo 0.0.22 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="nappo.html" >nappo package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="nappo.core.html" >nappo.core package</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, nappo.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>